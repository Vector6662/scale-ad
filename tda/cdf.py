from scipy.stats import genextreme
import numpy as np
import matplotlib.pyplot as plt


data = [42, 109, 1, 1, 1, 2, 1, 1, 28, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 721, 1, 18, 1, 17, 2, 1, 1,
        2, 2, 7, 3, 3, 2, 5, 4, 1, 2, 1, 1, 5, 2, 1, 1, 121, 3, 9, 5, 30, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        2, 1, 1, 1, 4, 5, 1, 1, 1, 3, 2, 2, 2, 2, 2, 3, 1, 3, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 7, 5, 3, 1, 1, 2, 1, 11, 1, 1, 1, 1, 2, 2, 1, 2, 1, 1, 2, 1,
        1, 2, 1, 1, 3, 5, 1, 1, 1, 1, 1, 2, 8, 5, 1, 1, 2, 1, 2, 3, 1, 5, 6, 16, 7, 51, 71, 9, 3, 2, 2, 60, 30, 20, 8,
        5, 5, 3, 1, 5, 5, 3, 2, 4, 3, 4, 1, 2, 5, 1, 1, 2, 5, 7, 5, 2, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 3, 21, 4, 2, 1, 1,
        17, 16, 23, 6, 9, 1, 20, 5, 2, 1, 1, 1, 1, 1, 1, 1, 1, 6, 1, 1, 6, 1, 6, 35]

label = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
data = np.array(data)
x = np.arange(0, len(data))
fig, (ax1, ax2, ax3) = plt.subplots(3, 1)

c = -0.5
mean, var, skew, kurt = genextreme.stats(c, moments='mvsk')

print('stats:', mean, var, skew, kurt)

# x = np.linspace(genextreme.ppf(0.01, c), genextreme.ppf(0.99, c), 100)
cdf = genextreme.cdf(data, c)
print('cdf:\n', cdf)
ax1.plot(x, data, 'r-', label='origin')
ax2.plot(x, cdf, 'k-', label='cdf')

T = 10

tp = cdf**T/np.sum(cdf)**T
print('tp:\n', tp)

ax3.plot(x, tp, label='tp')


plt.show()


